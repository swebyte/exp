import{A as q,B,m as D,r as y,s as F,u as E,v as I,w as V,x as T,y as U,z as W}from"./chunk-HGW3F55W.js";import{Bb as c,Ib as N,Lb as s,Na as l,Nb as b,Pb as h,Qb as x,Rb as v,Ub as P,ab as O,ba as M,ga as f,ha as p,kb as g,lb as u,oa as d,ob as _,pb as o,qb as r,rb as C,vb as S,zb as w}from"./chunk-ZTWUCJV6.js";var L=()=>({updateOn:"change"});function A(i,n){i&1&&(o(0,"div",5)(1,"div",7)(2,"span",8),s(3,"Loading..."),r()()())}function Y(i,n){if(i&1&&(o(0,"div",11),C(1,"i",21),s(2),r()),i&2){let e=c(2);l(2),b("",e.successMessage()," ")}}function k(i,n){if(i&1&&(o(0,"div",12),C(1,"i",22),s(2),r()),i&2){let e=c(2);l(2),b("",e.errorMessage()," ")}}function z(i,n){if(i&1){let e=S();o(0,"div",6)(1,"div",9)(2,"form",10,0),w("ngSubmit",function(){f(e);let a=c();return p(a.saveProfile())}),g(4,Y,3,1,"div",11),g(5,k,3,1,"div",12),o(6,"div",13)(7,"label",14),s(8,"Full Name"),r(),o(9,"input",15),v("ngModelChange",function(a){f(e);let m=c();return x(m.fullname,a)||(m.fullname=a),p(a)}),r()(),o(10,"div",13)(11,"label",16),s(12,"Email"),r(),o(13,"input",17),v("ngModelChange",function(a){f(e);let m=c();return x(m.email,a)||(m.email=a),p(a)}),r()(),o(14,"div",18)(15,"button",19),C(16,"i",20),s(17," Save Changes "),r()()()()()}if(i&2){let e=N(3),t=c();l(4),u(t.successMessage()?4:-1),l(),u(t.errorMessage()?5:-1),l(4),h("ngModel",t.fullname),_("ngModelOptions",P(7,L)),l(4),h("ngModel",t.email),_("ngModelOptions",P(8,L)),l(2),_("disabled",!e.form.valid)}}var j=class i{http=M(D);authService=M(F);fullname=d("");email=d("");userId=d(null);loading=d(!0);successMessage=d("");errorMessage=d("");ngOnInit(){this.loadProfileData()}loadProfileData(){let n=this.authService.getUserId();if(!n){this.errorMessage.set("You must be logged in to view your profile"),this.loading.set(!1);return}this.userId.set(n),this.loading.set(!0),this.http.get(`${y.apiBaseUrl}/users?id=eq.${n}`).subscribe({next:e=>{if(e.length>0){let t=e[0];this.fullname.set(t.fullname||""),this.email.set(t.email||"")}else this.errorMessage.set("User profile not found");this.loading.set(!1)},error:e=>{console.error("Failed to load profile:",e),this.errorMessage.set("Failed to load profile data"),this.loading.set(!1)}})}saveProfile(){this.successMessage.set(""),this.errorMessage.set("");let n=this.userId();if(!n){this.errorMessage.set("You must be logged in to update your profile");return}let e={fullname:this.fullname(),email:this.email()};this.http.patch(`${y.apiBaseUrl}/users?id=eq.${n}`,e).subscribe({next:()=>{this.successMessage.set("Profile updated successfully!")},error:t=>{console.error("Failed to update profile:",t),this.errorMessage.set("Failed to update profile. Please try again.")}})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=O({type:i,selectors:[["app-profile"]],decls:9,vars:1,consts:[["profileForm","ngForm"],[1,"container","mt-4"],[1,"profile-container"],[1,"mb-4"],[1,"lead"],[1,"text-center"],[1,"card"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"card-body"],[3,"ngSubmit"],["role","alert",1,"alert","alert-success"],["role","alert",1,"alert","alert-danger"],[1,"mb-3"],["for","fullname",1,"form-label"],["type","text","id","fullname","name","fullname","required","",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],["for","email",1,"form-label"],["type","email","id","email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"d-flex","justify-content-end","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"bi","bi-save","pe-1"],[1,"bi","bi-check-circle-fill","pe-2"],[1,"bi","bi-exclamation-triangle-fill","pe-2"]],template:function(e,t){e&1&&(o(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),s(4,"Profile"),r(),o(5,"p",4),s(6,"Manage your account information."),r()(),g(7,A,4,0,"div",5)(8,z,18,9,"div",6),r()()),e&2&&(l(7),u(t.loading()?7:8))},dependencies:[B,W,E,I,V,q,U,T],styles:[".profile-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.profile-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:2.5rem;font-weight:700}.profile-container[_ngcontent-%COMP%]   .lead[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:0}.profile-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:1px solid #dee2e6;box-shadow:0 .125rem .25rem #00000013}.profile-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:2rem}.profile-container[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.profile-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#86b7fe;box-shadow:0 0 0 .25rem #0d6efd40}.profile-container[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]{display:flex;align-items:center}"]})};export{j as ProfileComponent};
