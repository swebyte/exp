import{a as Z}from"./chunk-IYCZIFL5.js";import{e as k,h as Q,i as X}from"./chunk-ZZBXHBLD.js";import{A as J,B as K,k as Y,m as O,r as M,s as A,t as j,u as L,v as R,w as z,x as H,y as G,z as $}from"./chunk-HGW3F55W.js";import{Bb as p,Jb as T,Lb as d,Mb as v,Na as l,Nb as S,Ob as q,Pb as _,Qb as u,Rb as x,Y as N,ab as w,ac as D,ba as m,ga as C,ha as f,kb as b,lb as h,mb as V,nb as U,oa as W,ob as E,pb as i,q as I,qb as r,rb as g,vb as P,ya as B,zb as s}from"./chunk-ZTWUCJV6.js";function re(a,n){if(a&1&&(i(0,"div",4),d(1),r()),a&2){let e=p();l(),v(e.errorMessage)}}function oe(a,n){if(a&1){let e=P();i(0,"textarea",29),x("ngModelChange",function(c){C(e);let o=p();return u(o.description,c)||(o.description=c),f(c)}),r()}if(a&2){let e=p();_("ngModel",e.description)}}function ae(a,n){if(a&1&&(i(0,"div",16),g(1,"markdown",30),r()),a&2){let e=p();l(),E("data",e.description||"*No content yet*")}}var y=class a{activeModal=m(Q);platformId=m(B);isBrowser=Y(this.platformId);http=m(O);experience;title="";company="";description="";start_date="";end_date="";isCurrentPosition=!1;errorMessage="";showPreview=!1;get isEditMode(){return!!this.experience}ngOnInit(){this.experience&&(this.title=this.experience.title,this.company=this.experience.company,this.description=this.experience.description,this.start_date=this.experience.start_date,this.end_date=this.experience.end_date||"",this.isCurrentPosition=!this.experience.end_date)}onImageUploaded(n){let e=`
<img src="${n}" alt="Image" width="600">
`;this.description=this.description+e}onSubmit(){let n={title:this.title,company:this.company,description:this.description,start_date:this.start_date,end_date:this.isCurrentPosition?null:this.end_date};this.isEditMode&&this.experience?this.http.patch(`${M.apiBaseUrl}/experience?id=eq.${this.experience.id}`,n).subscribe({next:e=>{console.log("Experience updated:",e),this.activeModal.close(e)},error:e=>{console.error("Failed to update experience:",e),this.errorMessage="Failed to update experience. Please try again."}}):this.http.post(`${M.apiBaseUrl}/experience`,n).subscribe({next:e=>{console.log("Experience created:",e),this.activeModal.close(e)},error:e=>{console.error("Failed to create experience:",e),this.errorMessage="Failed to create experience. Please try again."}})}onCurrentPositionChange(){this.isCurrentPosition&&(this.end_date="")}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=w({type:a,selectors:[["app-experience-form"]],inputs:{experience:"experience"},decls:44,vars:19,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"alert","alert-danger"],[3,"ngSubmit"],[1,"mb-3"],["for","title",1,"form-label"],["type","text","id","title","name","title","placeholder","e.g. Senior Developer","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","company",1,"form-label"],["type","text","id","company","name","company","placeholder","e.g. Tech Corp","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"imageUploaded"],["for","description",1,"form-label"],[1,"d-flex","gap-2","mb-2"],["type","button",1,"btn","btn-sm",3,"click"],["id","description","name","description","rows","10","placeholder","Describe your role and responsibilities... (Markdown supported)","required","",1,"form-control",3,"ngModel"],[1,"border","rounded","p-3",2,"min-height","250px","background-color","#fff"],[1,"row"],[1,"col-md-6","mb-3"],["for","start_date",1,"form-label"],["type","date","id","start_date","name","start_date","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","end_date",1,"form-label"],["type","date","id","end_date","name","end_date",1,"form-control",3,"ngModelChange","ngModel","disabled","required"],[1,"mb-3","form-check"],["type","checkbox","id","isCurrentPosition","name","isCurrentPosition",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","isCurrentPosition",1,"form-check-label"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"],["id","description","name","description","rows","10","placeholder","Describe your role and responsibilities... (Markdown supported)","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"data"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"h5",1),d(2),r(),i(3,"button",2),s("click",function(){return t.activeModal.dismiss()}),r()(),i(4,"div",3),b(5,re,2,1,"div",4),i(6,"form",5),s("ngSubmit",function(){return t.onSubmit()}),i(7,"div",6)(8,"label",7),d(9,"Title"),r(),i(10,"input",8),x("ngModelChange",function(o){return u(t.title,o)||(t.title=o),o}),r()(),i(11,"div",6)(12,"label",9),d(13,"Company"),r(),i(14,"input",10),x("ngModelChange",function(o){return u(t.company,o)||(t.company=o),o}),r()(),i(15,"app-image-upload",11),s("imageUploaded",function(o){return t.onImageUploaded(o)}),r(),i(16,"div",6)(17,"label",12),d(18,"Description (Markdown supported)"),r(),i(19,"div",13)(20,"button",14),s("click",function(){return t.showPreview=!1}),d(21," Edit "),r(),i(22,"button",14),s("click",function(){return t.showPreview=!0}),d(23," Preview "),r()(),b(24,oe,1,1,"textarea",15)(25,ae,2,1,"div",16),r(),i(26,"div",17)(27,"div",18)(28,"label",19),d(29,"Start Date"),r(),i(30,"input",20),x("ngModelChange",function(o){return u(t.start_date,o)||(t.start_date=o),o}),r()(),i(31,"div",18)(32,"label",21),d(33,"End Date"),r(),i(34,"input",22),x("ngModelChange",function(o){return u(t.end_date,o)||(t.end_date=o),o}),r()()(),i(35,"div",23)(36,"input",24),x("ngModelChange",function(o){return u(t.isCurrentPosition,o)||(t.isCurrentPosition=o),o}),s("change",function(){return t.onCurrentPositionChange()}),r(),i(37,"label",25),d(38," I currently work here "),r()(),i(39,"div",26)(40,"button",27),d(41),r(),i(42,"button",28),s("click",function(){return t.activeModal.dismiss()}),d(43," Cancel "),r()()()()),e&2&&(l(2),v(t.isEditMode?"Edit Experience":"New Experience"),l(3),h(t.errorMessage?5:-1),l(5),_("ngModel",t.title),l(4),_("ngModel",t.company),l(6),T("btn-primary",!t.showPreview)("btn-outline-primary",t.showPreview),l(2),T("btn-primary",t.showPreview)("btn-outline-primary",!t.showPreview),l(2),h(t.showPreview?25:24),l(6),_("ngModel",t.start_date),l(4),_("ngModel",t.end_date),E("disabled",t.isCurrentPosition)("required",!t.isCurrentPosition),l(2),_("ngModel",t.isCurrentPosition),l(5),S(" ",t.isEditMode?"Update Experience":"Save Experience"," "))},dependencies:[K,$,L,j,R,z,J,G,H,k,Z],styles:[".modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:600}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #007bff40}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]{resize:vertical}"]})};var F=class a{http=m(O);_experiences=W([]);experiences=D(()=>this._experiences());numYearsInBussiness=D(()=>{let n=this._experiences().reduce((e,t)=>{let c=new Date(t.start_date),o=t.end_date?new Date(t.end_date):new Date;if(isNaN(c.getTime())||isNaN(o.getTime()))return e;let ne=(o.getTime()-c.getTime())/(365.25*24*60*60*1e3);return e+ne},0);return Math.round(n)});loadExperiences(){this.http.get(`${M.apiBaseUrl}/experience?order=start_date.desc`).pipe(I(n=>n||[])).subscribe({next:n=>this._experiences.set(n),error:n=>{console.error("Failed to load experiences:",n),this._experiences.set([])}})}deleteExperience(n){return this.http.delete(`${M.apiBaseUrl}/experience?id=eq.${n}`)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=N({token:a,factory:a.\u0275fac,providedIn:"root"})};var ce=(a,n)=>n.created_at;function le(a,n){if(a&1){let e=P();i(0,"button",6),s("click",function(){C(e);let c=p();return f(c.openNewExperienceModal())}),g(1,"i",7),d(2," New Experience "),r()}}function de(a,n){if(a&1){let e=P();i(0,"div",15)(1,"button",18),s("click",function(){C(e);let c=p().$implicit,o=p();return f(o.openEditExperienceModal(c))}),g(2,"i",19),r(),i(3,"button",20),s("click",function(){C(e);let c=p().$implicit,o=p();return f(o.deleteExperience(c.id))}),g(4,"i",21),r()()}}function se(a,n){if(a&1&&(i(0,"div",5),g(1,"div",8),i(2,"div",9)(3,"div",10)(4,"div",11)(5,"div",12)(6,"h5",13),d(7),r(),i(8,"p",14),d(9),r()(),b(10,de,5,0,"div",15),r(),i(11,"div",16),g(12,"markdown",17),r()()()()),a&2){let e=n.$implicit,t=p();l(7),v(e.title),l(2),q(" ",e.company," \u2022 ",t.formatDateRange(e.start_date,e.end_date)," "),l(),h(t.authService.isAuthenticated()?10:-1),l(2),E("data",e.description)}}var te=class a{authService=m(A);modalService=m(X);experienceService=m(F);experiences=this.experienceService.experiences;numYearsInBusiness=this.experienceService.numYearsInBussiness;ngOnInit(){this.experienceService.loadExperiences()}deleteExperience(n){confirm("Are you sure you want to delete this experience?")&&this.experienceService.deleteExperience(n).subscribe({next:()=>{console.log("Experience deleted"),this.experienceService.loadExperiences()},error:e=>{console.error("Failed to delete experience:",e)}})}openNewExperienceModal(){this.modalService.open(y,{centered:!0,size:"lg"}).result.then(e=>{console.log("Experience created:",e),this.experienceService.loadExperiences()},e=>{console.log("Modal dismissed")})}openEditExperienceModal(n){let e=this.modalService.open(y,{centered:!0,size:"lg"});e.componentInstance.experience=n,e.result.then(t=>{console.log("Experience updated:",t),this.experienceService.loadExperiences()},t=>{console.log("Modal dismissed")})}formatDateRange(n,e){let t=new Date(n).getFullYear(),c=e?new Date(e).getFullYear():"Present";return`${t} - ${c}`}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=w({type:a,selectors:[["app-experience"]],decls:12,vars:2,consts:[[1,"container","mt-4"],[1,"experience-container"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"btn","btn-primary"],[1,"timeline","mt-4"],[1,"timeline-item"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-circle","pe-1"],[1,"timeline-badge"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-start"],[1,"flex-grow-1"],[1,"card-title"],[1,"text-muted"],[1,"d-flex","gap-1"],[1,"card-text"],[3,"data"],["title","Edit experience",1,"btn","btn-link","text-primary",3,"click"],[1,"bi","bi-pencil"],["title","Delete experience",1,"btn","btn-link","text-danger","delete-btn",3,"click"],[1,"bi","bi-trash"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1"),d(5,"Experience"),r(),i(6,"h5"),d(7),r()(),b(8,le,3,0,"button",3),r(),i(9,"div",4),V(10,se,13,5,"div",5,ce),r()()()),e&2&&(l(7),S("",t.numYearsInBusiness()," years in the business"),l(),h(t.authService.isAuthenticated()?8:-1),l(2),U(t.experiences()))},dependencies:[k],styles:['.experience-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:1rem}.experience-container[_ngcontent-%COMP%]   .lead[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]{position:relative;padding-left:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]:before{content:"";position:absolute;left:10px;top:0;bottom:0;width:2px;background:#e9ecef}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]{position:relative;margin-bottom:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-badge[_ngcontent-%COMP%]{position:absolute;left:-2rem;top:.9rem;width:20px;height:20px;border-radius:50%;background:#000;border:3px solid #fff;box-shadow:0 0 0 2px #e9ecef}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{box-shadow:0 2px 4px #0000001a}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{color:#495057;font-weight:600}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{padding:.25rem .5rem;opacity:.6;transition:opacity .2s}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{opacity:1}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-bottom:0}']})};export{te as ExperienceComponent};
