import{a as J}from"./chunk-BQOB3HVR.js";import{A as H,C as G,D as $,e as V,h as O,o as h,p as B,q as S,s as U,t as q,u as A,v as L,w as R,x as j,y as z,z as Y}from"./chunk-5SA7GSO3.js";import{Bb as s,Jb as k,Lb as d,Mb as y,Na as c,Nb as N,Ob as W,Pb as g,Qb as u,Rb as x,ab as v,ba as m,ga as C,ha as f,kb as b,lb as M,mb as D,nb as I,oa as F,ob as E,pb as n,qb as i,rb as _,vb as P,ya as T,zb as p}from"./chunk-PUFU6ETD.js";function Z(l,o){if(l&1&&(n(0,"div",4),d(1),i()),l&2){let e=s();c(),y(e.errorMessage)}}function ee(l,o){if(l&1){let e=P();n(0,"textarea",29),x("ngModelChange",function(a){C(e);let r=s();return u(r.description,a)||(r.description=a),f(a)}),i()}if(l&2){let e=s();g("ngModel",e.description)}}function te(l,o){if(l&1&&(n(0,"div",16),_(1,"markdown",30),i()),l&2){let e=s();c(),E("data",e.description||"*No content yet*")}}var w=class l{activeModal=m(G);platformId=m(T);isBrowser=V(this.platformId);http=m(O);experience;title="";company="";description="";start_date="";end_date="";isCurrentPosition=!1;errorMessage="";showPreview=!1;get isEditMode(){return!!this.experience}ngOnInit(){this.experience&&(this.title=this.experience.title,this.company=this.experience.company,this.description=this.experience.description,this.start_date=this.experience.start_date,this.end_date=this.experience.end_date||"",this.isCurrentPosition=!this.experience.end_date)}onImageUploaded(o){let e=`
<img src="${o}" alt="Image" width="600">
`;this.description=this.description+e}onSubmit(){let o={title:this.title,company:this.company,description:this.description,start_date:this.start_date,end_date:this.isCurrentPosition?null:this.end_date};this.isEditMode&&this.experience?this.http.patch(`${h.apiBaseUrl}/experience?id=eq.${this.experience.id}`,o).subscribe({next:e=>{console.log("Experience updated:",e),this.activeModal.close(e)},error:e=>{console.error("Failed to update experience:",e),this.errorMessage="Failed to update experience. Please try again."}}):this.http.post(`${h.apiBaseUrl}/experience`,o).subscribe({next:e=>{console.log("Experience created:",e),this.activeModal.close(e)},error:e=>{console.error("Failed to create experience:",e),this.errorMessage="Failed to create experience. Please try again."}})}onCurrentPositionChange(){this.isCurrentPosition&&(this.end_date="")}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=v({type:l,selectors:[["app-experience-form"]],inputs:{experience:"experience"},decls:44,vars:19,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"alert","alert-danger"],[3,"ngSubmit"],[1,"mb-3"],["for","title",1,"form-label"],["type","text","id","title","name","title","placeholder","e.g. Senior Developer","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","company",1,"form-label"],["type","text","id","company","name","company","placeholder","e.g. Tech Corp","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"imageUploaded"],["for","description",1,"form-label"],[1,"d-flex","gap-2","mb-2"],["type","button",1,"btn","btn-sm",3,"click"],["id","description","name","description","rows","10","placeholder","Describe your role and responsibilities... (Markdown supported)","required","",1,"form-control",3,"ngModel"],[1,"border","rounded","p-3",2,"min-height","250px","background-color","#fff"],[1,"row"],[1,"col-md-6","mb-3"],["for","start_date",1,"form-label"],["type","date","id","start_date","name","start_date","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","end_date",1,"form-label"],["type","date","id","end_date","name","end_date",1,"form-control",3,"ngModelChange","ngModel","disabled","required"],[1,"mb-3","form-check"],["type","checkbox","id","isCurrentPosition","name","isCurrentPosition",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","isCurrentPosition",1,"form-check-label"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"],["id","description","name","description","rows","10","placeholder","Describe your role and responsibilities... (Markdown supported)","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"data"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"h5",1),d(2),i(),n(3,"button",2),p("click",function(){return t.activeModal.dismiss()}),i()(),n(4,"div",3),b(5,Z,2,1,"div",4),n(6,"form",5),p("ngSubmit",function(){return t.onSubmit()}),n(7,"div",6)(8,"label",7),d(9,"Title"),i(),n(10,"input",8),x("ngModelChange",function(r){return u(t.title,r)||(t.title=r),r}),i()(),n(11,"div",6)(12,"label",9),d(13,"Company"),i(),n(14,"input",10),x("ngModelChange",function(r){return u(t.company,r)||(t.company=r),r}),i()(),n(15,"app-image-upload",11),p("imageUploaded",function(r){return t.onImageUploaded(r)}),i(),n(16,"div",6)(17,"label",12),d(18,"Description (Markdown supported)"),i(),n(19,"div",13)(20,"button",14),p("click",function(){return t.showPreview=!1}),d(21," Edit "),i(),n(22,"button",14),p("click",function(){return t.showPreview=!0}),d(23," Preview "),i()(),b(24,ee,1,1,"textarea",15)(25,te,2,1,"div",16),i(),n(26,"div",17)(27,"div",18)(28,"label",19),d(29,"Start Date"),i(),n(30,"input",20),x("ngModelChange",function(r){return u(t.start_date,r)||(t.start_date=r),r}),i()(),n(31,"div",18)(32,"label",21),d(33,"End Date"),i(),n(34,"input",22),x("ngModelChange",function(r){return u(t.end_date,r)||(t.end_date=r),r}),i()()(),n(35,"div",23)(36,"input",24),x("ngModelChange",function(r){return u(t.isCurrentPosition,r)||(t.isCurrentPosition=r),r}),p("change",function(){return t.onCurrentPositionChange()}),i(),n(37,"label",25),d(38," I currently work here "),i()(),n(39,"div",26)(40,"button",27),d(41),i(),n(42,"button",28),p("click",function(){return t.activeModal.dismiss()}),d(43," Cancel "),i()()()()),e&2&&(c(2),y(t.isEditMode?"Edit Experience":"New Experience"),c(3),M(t.errorMessage?5:-1),c(5),g("ngModel",t.title),c(4),g("ngModel",t.company),c(6),k("btn-primary",!t.showPreview)("btn-outline-primary",t.showPreview),c(2),k("btn-primary",t.showPreview)("btn-outline-primary",!t.showPreview),c(2),M(t.showPreview?25:24),c(6),g("ngModel",t.start_date),c(4),g("ngModel",t.end_date),E("disabled",t.isCurrentPosition)("required",!t.isCurrentPosition),c(2),g("ngModel",t.isCurrentPosition),c(5),N(" ",t.isEditMode?"Update Experience":"Save Experience"," "))},dependencies:[H,z,q,U,A,L,Y,j,R,S,J],styles:[".modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:600}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #007bff40}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]{resize:vertical}"]})};var ne=(l,o)=>o.created_at;function ie(l,o){if(l&1){let e=P();n(0,"button",7),p("click",function(){C(e);let a=s();return f(a.openNewExperienceModal())}),_(1,"i",8),d(2," New Experience "),i()}}function oe(l,o){if(l&1){let e=P();n(0,"div",16)(1,"button",19),p("click",function(){C(e);let a=s().$implicit,r=s();return f(r.openEditExperienceModal(a))}),_(2,"i",20),i(),n(3,"button",21),p("click",function(){C(e);let a=s().$implicit,r=s();return f(r.deleteExperience(a.id))}),_(4,"i",22),i()()}}function re(l,o){if(l&1&&(n(0,"div",6),_(1,"div",9),n(2,"div",10)(3,"div",11)(4,"div",12)(5,"div",13)(6,"h5",14),d(7),i(),n(8,"p",15),d(9),i()(),b(10,oe,5,0,"div",16),i(),n(11,"div",17),_(12,"markdown",18),i()()()()),l&2){let e=o.$implicit,t=s();c(7),y(e.title),c(2),W(" ",e.company," \u2022 ",t.formatDateRange(e.start_date,e.end_date)," "),c(),M(t.authService.isAuthenticated()?10:-1),c(2),E("data",e.description)}}var K=class l{authService=m(B);modalService=m($);http=m(O);experiences=F([]);ngOnInit(){this.loadExperiences()}loadExperiences(){this.http.get(`${h.apiBaseUrl}/experience?order=start_date.desc`).subscribe({next:o=>{this.experiences.set(o)},error:o=>{console.error("Failed to load experiences:",o)}})}deleteExperience(o){confirm("Are you sure you want to delete this experience?")&&this.http.delete(`${h.apiBaseUrl}/experience?id=eq.${o}`).subscribe({next:()=>{console.log("Experience deleted"),this.loadExperiences()},error:e=>{console.error("Failed to delete experience:",e)}})}openNewExperienceModal(){this.modalService.open(w,{centered:!0,size:"lg"}).result.then(e=>{console.log("Experience created:",e),this.loadExperiences()},e=>{console.log("Modal dismissed")})}openEditExperienceModal(o){let e=this.modalService.open(w,{centered:!0,size:"lg"});e.componentInstance.experience=o,e.result.then(t=>{console.log("Experience updated:",t),this.loadExperiences()},t=>{console.log("Modal dismissed")})}formatDateRange(o,e){let t=new Date(o).getFullYear(),a=e?new Date(e).getFullYear():"Present";return`${t} - ${a}`}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=v({type:l,selectors:[["app-experience"]],decls:12,vars:1,consts:[[1,"container","mt-4"],[1,"experience-container"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"lead"],[1,"btn","btn-primary"],[1,"timeline","mt-4"],[1,"timeline-item"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-circle","pe-1"],[1,"timeline-badge"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-start"],[1,"flex-grow-1"],[1,"card-title"],[1,"text-muted"],[1,"d-flex","gap-1"],[1,"card-text"],[3,"data"],["title","Edit experience",1,"btn","btn-link","text-primary",3,"click"],[1,"bi","bi-pencil"],["title","Delete experience",1,"btn","btn-link","text-danger","delete-btn",3,"click"],[1,"bi","bi-trash"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1"),d(5,"Experience"),i(),n(6,"p",3),d(7,"My professional journey and life history."),i()(),b(8,ie,3,0,"button",4),i(),n(9,"div",5),D(10,re,13,5,"div",6,ne),i()()()),e&2&&(c(8),M(t.authService.isAuthenticated()?8:-1),c(2),I(t.experiences()))},dependencies:[S],styles:['.experience-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:1rem}.experience-container[_ngcontent-%COMP%]   .lead[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]{position:relative;padding-left:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]:before{content:"";position:absolute;left:10px;top:0;bottom:0;width:2px;background:#e9ecef}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]{position:relative;margin-bottom:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-badge[_ngcontent-%COMP%]{position:absolute;left:-2rem;top:.9rem;width:20px;height:20px;border-radius:50%;background:#000;border:3px solid #fff;box-shadow:0 0 0 2px #e9ecef}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{box-shadow:0 2px 4px #0000001a}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{color:#495057;font-weight:600}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{padding:.25rem .5rem;opacity:.6;transition:opacity .2s}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{opacity:1}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-bottom:0}']})};export{K as ExperienceComponent};
