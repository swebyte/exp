import{a as _e}from"./chunk-SJQ2B3S3.js";import{e as F,h as me,i as ge}from"./chunk-STM5T3Q6.js";import{A as de,B as pe,C as se,f as Q,g as X,h as ee,l as te,n as T,s as E,t as ne,u as ie,v as re,w as oe,x as ae,y as ce,z as le}from"./chunk-6RF4LEQF.js";import{$b as K,Cb as s,Eb as p,Fb as G,Gb as Z,Lb as $,Mb as B,Na as l,Ob as d,Pb as x,Qb as v,Rb as J,Sb as f,Tb as u,Ub as C,Y as z,Zb as I,_b as k,ab as M,ba as m,ec as L,fb as P,ga as b,ha as h,lb as y,mb as w,nb as q,oa as U,ob as A,pb as g,q as V,qb as n,rb as i,sb as _,wb as R,xb as H,ya as j,yb as O}from"./chunk-6ZM7RP27.js";var Ce=[[["",8,"controls"]]],be=[".controls"];function he(o,r){if(o&1&&(n(0,"p",7),d(1),i()),o&2){let e=p(2);l(),v(" ",e.experience.description," ")}}function Me(o,r){if(o&1&&(R(0),n(1,"div",2)(2,"div",3)(3,"div",4),d(4),I(5,"date"),i(),n(6,"h5",5),d(7),i(),P(8,he,2,1,"p",6),i()(),H()),o&2){let e=p();l(4),x(k(5,3,e.experience.start_date,"yyyy")),l(3),x(e.experience.title),l(),g("ngIf",e.experience.description)}}function ve(o,r){if(o&1&&(n(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"h5",12),d(5),i(),n(6,"p",13),d(7),I(8,"date"),I(9,"date"),i()(),n(10,"div",14),Z(11),i()(),n(12,"div",15),_(13,"markdown",16),i()()()),o&2){let e=p();l(5),x(e.experience.title),l(2),J(" ",e.experience.company," \u2022 ",k(8,5,e.experience.start_date,"yyyy"),"",e.experience.end_date?" - "+k(9,8,e.experience.end_date,"yyyy"):""," "),l(6),g("data",e.experience.description)}}var D=class o{experience;isLifeEvent=!1;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=M({type:o,selectors:[["experience-card"]],inputs:{experience:"experience",isLifeEvent:"isLifeEvent"},ngContentSelectors:be,decls:3,vars:2,consts:[["normal",""],[4,"ngIf","ngIfElse"],[1,"card","life-event-card","text-center"],[1,"card-body","d-flex","flex-column","align-items-center"],[1,"event-circle"],[1,"mt-2","mb-1"],["class","small text-muted mb-0",4,"ngIf"],[1,"small","text-muted","mb-0"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-start"],[1,"flex-grow-1"],[1,"card-title"],[1,"text-muted"],[1,"d-flex","gap-1"],[1,"card-text"],[3,"data"]],template:function(e,t){if(e&1&&(G(Ce),P(0,Me,9,6,"ng-container",1)(1,ve,14,11,"ng-template",null,0,K)),e&2){let c=$(2);g("ngIf",t.isLifeEvent)("ngIfElse",c)}},dependencies:[ee,Q,F,X],styles:['.card[_ngcontent-%COMP%]{box-shadow:0 2px 4px #0000001a}.life-event-card[_ngcontent-%COMP%]{background:linear-gradient(180deg,#f8f9fa,#e9ecef);border:1px solid rgba(108,117,125,.12);position:relative;overflow:visible;margin-left:1.6rem}.life-event-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.25rem}.life-event-card[_ngcontent-%COMP%]   .event-circle[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:#6c757d;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:1.125rem;box-shadow:0 2px 6px #0000000f}.life-event-card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .life-event-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#495057}.life-event-card[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-30px;top:50%;transform:translateY(-50%);width:0;height:0;border-top:12px solid transparent;border-bottom:12px solid transparent;border-right:12px solid #e9ecef;z-index:1}.life-event-card[_ngcontent-%COMP%]:after{content:"";position:absolute;left:-26px;top:50%;transform:translateY(-50%);width:0;height:0;border-top:10px solid transparent;border-bottom:10px solid transparent;border-right:10px solid #ffffff;z-index:2}.card[_ngcontent-%COMP%]:not(.life-event-card){position:relative;overflow:visible;margin-left:1.6rem}.card[_ngcontent-%COMP%]:not(.life-event-card):before{content:"";position:absolute;left:-30px;top:50%;transform:translateY(-50%);width:0;height:0;border-top:12px solid transparent;border-bottom:12px solid transparent;border-right:12px solid #e9ecef;z-index:1}.card[_ngcontent-%COMP%]:not(.life-event-card):after{content:"";position:absolute;left:-26px;top:50%;transform:translateY(-50%);width:0;height:0;border-top:10px solid transparent;border-bottom:10px solid transparent;border-right:10px solid #ffffff;z-index:2}']})};function Ee(o,r){if(o&1&&(n(0,"div",4),d(1),i()),o&2){let e=p();l(),x(e.errorMessage)}}function Pe(o,r){if(o&1){let e=O();n(0,"textarea",29),C("ngModelChange",function(c){b(e);let a=p();return u(a.description,c)||(a.description=c),h(c)}),i()}if(o&2){let e=p();f("ngModel",e.description)}}function ye(o,r){if(o&1&&(n(0,"div",16),_(1,"markdown",30),i()),o&2){let e=p();l(),g("data",e.description||"*No content yet*")}}var S=class o{activeModal=m(me);platformId=m(j);isBrowser=te(this.platformId);http=m(T);experience;title="";company="";description="";start_date="";end_date="";isCurrentPosition=!1;errorMessage="";showPreview=!1;get isEditMode(){return!!this.experience}ngOnInit(){this.experience&&(this.title=this.experience.title,this.company=this.experience.company,this.description=this.experience.description,this.start_date=this.experience.start_date,this.end_date=this.experience.end_date||"",this.isCurrentPosition=!this.experience.end_date)}onImageUploaded(r){let e=`
<img src="${r}" alt="Image" width="600">
`;this.description=this.description+e}onSubmit(){let r={title:this.title,company:this.company,description:this.description,start_date:this.start_date,end_date:this.isCurrentPosition?null:this.end_date};this.isEditMode&&this.experience?this.http.patch(`${E.apiBaseUrl}/experience?id=eq.${this.experience.id}`,r).subscribe({next:e=>{console.log("Experience updated:",e),this.activeModal.close(e)},error:e=>{console.error("Failed to update experience:",e),this.errorMessage="Failed to update experience. Please try again."}}):this.http.post(`${E.apiBaseUrl}/experience`,r).subscribe({next:e=>{console.log("Experience created:",e),this.activeModal.close(e)},error:e=>{console.error("Failed to create experience:",e),this.errorMessage="Failed to create experience. Please try again."}})}onCurrentPositionChange(){this.isCurrentPosition&&(this.end_date="")}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=M({type:o,selectors:[["app-experience-form"]],inputs:{experience:"experience"},decls:44,vars:19,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"alert","alert-danger"],[3,"ngSubmit"],[1,"mb-3"],["for","title",1,"form-label"],["type","text","id","title","name","title","placeholder","e.g. Senior Developer","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","company",1,"form-label"],["type","text","id","company","name","company","placeholder","e.g. Tech Corp","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"imageUploaded"],["for","description",1,"form-label"],[1,"d-flex","gap-2","mb-2"],["type","button",1,"btn","btn-sm",3,"click"],["id","description","name","description","rows","10","placeholder","Describe your role and responsibilities... (Markdown supported)","required","",1,"form-control",3,"ngModel"],[1,"border","rounded","p-3",2,"min-height","250px","background-color","#fff"],[1,"row"],[1,"col-md-6","mb-3"],["for","start_date",1,"form-label"],["type","date","id","start_date","name","start_date","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","end_date",1,"form-label"],["type","date","id","end_date","name","end_date",1,"form-control",3,"ngModelChange","ngModel","disabled","required"],[1,"mb-3","form-check"],["type","checkbox","id","isCurrentPosition","name","isCurrentPosition",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","isCurrentPosition",1,"form-check-label"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"],["id","description","name","description","rows","10","placeholder","Describe your role and responsibilities... (Markdown supported)","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"data"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"h5",1),d(2),i(),n(3,"button",2),s("click",function(){return t.activeModal.dismiss()}),i()(),n(4,"div",3),y(5,Ee,2,1,"div",4),n(6,"form",5),s("ngSubmit",function(){return t.onSubmit()}),n(7,"div",6)(8,"label",7),d(9,"Title"),i(),n(10,"input",8),C("ngModelChange",function(a){return u(t.title,a)||(t.title=a),a}),i()(),n(11,"div",6)(12,"label",9),d(13,"Company"),i(),n(14,"input",10),C("ngModelChange",function(a){return u(t.company,a)||(t.company=a),a}),i()(),n(15,"app-image-upload",11),s("imageUploaded",function(a){return t.onImageUploaded(a)}),i(),n(16,"div",6)(17,"label",12),d(18,"Description (Markdown supported)"),i(),n(19,"div",13)(20,"button",14),s("click",function(){return t.showPreview=!1}),d(21," Edit "),i(),n(22,"button",14),s("click",function(){return t.showPreview=!0}),d(23," Preview "),i()(),y(24,Pe,1,1,"textarea",15)(25,ye,2,1,"div",16),i(),n(26,"div",17)(27,"div",18)(28,"label",19),d(29,"Start Date"),i(),n(30,"input",20),C("ngModelChange",function(a){return u(t.start_date,a)||(t.start_date=a),a}),i()(),n(31,"div",18)(32,"label",21),d(33,"End Date"),i(),n(34,"input",22),C("ngModelChange",function(a){return u(t.end_date,a)||(t.end_date=a),a}),i()()(),n(35,"div",23)(36,"input",24),C("ngModelChange",function(a){return u(t.isCurrentPosition,a)||(t.isCurrentPosition=a),a}),s("change",function(){return t.onCurrentPositionChange()}),i(),n(37,"label",25),d(38," I currently work here "),i()(),n(39,"div",26)(40,"button",27),d(41),i(),n(42,"button",28),s("click",function(){return t.activeModal.dismiss()}),d(43," Cancel "),i()()()()),e&2&&(l(2),x(t.isEditMode?"Edit Experience":"New Experience"),l(3),w(t.errorMessage?5:-1),l(5),f("ngModel",t.title),l(4),f("ngModel",t.company),l(6),B("btn-primary",!t.showPreview)("btn-outline-primary",t.showPreview),l(2),B("btn-primary",t.showPreview)("btn-outline-primary",!t.showPreview),l(2),w(t.showPreview?25:24),l(6),f("ngModel",t.start_date),l(4),f("ngModel",t.end_date),g("disabled",t.isCurrentPosition)("required",!t.isCurrentPosition),l(2),f("ngModel",t.isCurrentPosition),l(5),v(" ",t.isEditMode?"Update Experience":"Save Experience"," "))},dependencies:[se,de,re,ie,oe,ae,pe,le,ce,F,_e],styles:[".modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:600}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #007bff40}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]{resize:vertical}"]})};var Y="LifeEvent",N=class o{http=m(T);_experiences=U([]);experiences=L(()=>this._experiences());numYearsInBussiness=L(()=>{let r=this._experiences().reduce((e,t)=>{let c=new Date(t.start_date),a=t.end_date?new Date(t.end_date):new Date;if(isNaN(c.getTime())||isNaN(a.getTime()))return e;let ue=(a.getTime()-c.getTime())/(365.25*24*60*60*1e3);return e+ue},0);return Math.round(r)});loadExperiences(){this.http.get(`${E.apiBaseUrl}/experience?order=start_date.desc`).pipe(V(r=>r||[])).subscribe({next:r=>this._experiences.set([...r,{id:0,title:"I was born.",company:"",description:"",start_date:"1994-01-01T00:00:00.000Z",end_date:null,created_at:new Date().toISOString(),user_id:"",type:Y}]),error:r=>{console.error("Failed to load experiences:",r),this._experiences.set([])}})}deleteExperience(r){return this.http.delete(`${E.apiBaseUrl}/experience?id=eq.${r}`)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=z({token:o,factory:o.\u0275fac,providedIn:"root"})};var we=(o,r)=>r.created_at;function Oe(o,r){if(o&1){let e=O();n(0,"button",6),s("click",function(){b(e);let c=p();return h(c.openNewExperienceModal())}),_(1,"i",7),d(2," New Experience "),i()}}function Se(o,r){if(o&1){let e=O();n(0,"div",11)(1,"button",12),s("click",function(){b(e);let c=p().$implicit,a=p();return h(a.openEditExperienceModal(c))}),_(2,"i",13),i(),n(3,"button",14),s("click",function(){b(e);let c=p().$implicit,a=p();return h(a.deleteExperience(c.id))}),_(4,"i",15),i()()}}function Ie(o,r){if(o&1&&(n(0,"div",5),_(1,"div",8),n(2,"experience-card",9),P(3,Se,5,0,"div",10),i()()),o&2){let e=r.$implicit,t=p();l(2),g("experience",e)("isLifeEvent",e.type===t.ExpericeType_LifeEvent),l(),g("ngIf",t.authService.isAuthenticated())}}var fe=class o{authService=m(ne);modalService=m(ge);experienceService=m(N);experiences=this.experienceService.experiences;ExpericeType_LifeEvent=Y;numYearsInBusiness=this.experienceService.numYearsInBussiness;ngOnInit(){this.experienceService.loadExperiences()}deleteExperience(r){confirm("Are you sure you want to delete this experience?")&&this.experienceService.deleteExperience(r).subscribe({next:()=>{console.log("Experience deleted"),this.experienceService.loadExperiences()},error:e=>{console.error("Failed to delete experience:",e)}})}openNewExperienceModal(){this.modalService.open(S,{centered:!0,size:"lg"}).result.then(e=>{console.log("Experience created:",e),this.experienceService.loadExperiences()},e=>{console.log("Modal dismissed")})}openEditExperienceModal(r){let e=this.modalService.open(S,{centered:!0,size:"lg"});e.componentInstance.experience=r,e.result.then(t=>{console.log("Experience updated:",t),this.experienceService.loadExperiences()},t=>{console.log("Modal dismissed")})}formatDateRange(r,e){let t=new Date(r).getFullYear(),c=e?new Date(e).getFullYear():"Present";return`${t} - ${c}`}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=M({type:o,selectors:[["app-experience"]],decls:12,vars:2,consts:[[1,"container","mt-4"],[1,"experience-container"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"btn","btn-primary"],[1,"timeline","mt-4"],[1,"timeline-item"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-circle","pe-1"],[1,"timeline-badge"],[3,"experience","isLifeEvent"],["class","controls",4,"ngIf"],[1,"controls"],["title","Edit experience",1,"btn","btn-link","text-primary",3,"click"],[1,"bi","bi-pencil"],["title","Delete experience",1,"btn","btn-link","text-danger","delete-btn",3,"click"],[1,"bi","bi-trash"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1"),d(5,"Experience"),i(),n(6,"h5"),d(7),i()(),y(8,Oe,3,0,"button",3),i(),n(9,"div",4),q(10,Ie,4,3,"div",5,we),i()()()),e&2&&(l(7),v("",t.numYearsInBusiness()," years in the business"),l(),w(t.authService.isAuthenticated()?8:-1),l(2),A(t.experiences()))},dependencies:[D],styles:['.experience-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:1rem}.experience-container[_ngcontent-%COMP%]   .lead[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]{position:relative;padding-left:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]:before{content:"";position:absolute;left:10px;top:0;bottom:0;width:2px;background:#e9ecef}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]{position:relative;margin-bottom:2rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-badge[_ngcontent-%COMP%]{position:absolute;left:-2rem;top:50%;transform:translateY(-50%);width:20px;height:20px;border-radius:50%;background:#000;border:3px solid #fff;box-shadow:0 0 0 2px #e9ecef}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{box-shadow:0 2px 4px #0000001a}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{color:#495057;font-weight:600}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{padding:.25rem .5rem;opacity:.6;transition:opacity .2s}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{opacity:1}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-bottom:0}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.life-event-card){position:relative;overflow:visible;margin-left:1.6rem}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.life-event-card):before{content:"";position:absolute;left:-30px;top:50%;transform:translateY(-50%);width:0;height:0;border-top:12px solid transparent;border-bottom:12px solid transparent;border-right:12px solid #e9ecef;z-index:1}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.life-event-card):after{content:"";position:absolute;left:-26px;top:50%;transform:translateY(-50%);width:0;height:0;border-top:10px solid transparent;border-bottom:10px solid transparent;border-right:10px solid #ffffff;z-index:2}.experience-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-badge[_ngcontent-%COMP%]{z-index:4}']})};export{fe as ExperienceComponent};
