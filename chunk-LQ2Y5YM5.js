import{a as z}from"./chunk-BQOB3HVR.js";import{A as R,C as j,e as I,h as O,o as y,p as T,q as N,t as D,u as U,v as W,w as V,x as q,y as A,z as L}from"./chunk-5SA7GSO3.js";import{Bb as p,Jb as u,Lb as d,Mb as _,Na as l,Nb as k,Pb as f,Qb as h,Rb as C,a as M,ab as S,b as P,ba as g,ga as w,ha as v,kb as c,lb as b,ob as x,pb as o,qb as i,rb as F,vb as E,ya as B,zb as m}from"./chunk-PUFU6ETD.js";function H(r,a){if(r&1&&(o(0,"div",4),d(1),i()),r&2){let t=p();l(),_(t.errorMessage)}}function Y(r,a){if(r&1){let t=E();o(0,"textarea",18),C("ngModelChange",function(n){w(t);let s=p();return h(s.body,n)||(s.body=n),v(n)}),i()}if(r&2){let t=p();f("ngModel",t.body)}}function J(r,a){if(r&1&&(o(0,"div",14),F(1,"markdown",19),i()),r&2){let t=p();l(),x("data",t.body||"*No content yet*")}}var G=class r{activeModal=g(j);platformId=g(B);isBrowser=I(this.platformId);http=g(O);authService=g(T);blogPost;title="";body="";errorMessage="";showPreview=!1;get isEditMode(){return!!this.blogPost}ngOnInit(){this.blogPost&&(this.title=this.blogPost.title,this.body=this.blogPost.body)}onImageUploaded(a){let t=`
<img src="${a}" alt="Image" width="600">
`;this.body=this.body+t}onSubmit(){let a=this.authService.getUserId();if(!a){this.errorMessage="You must be logged in to create/edit posts";return}let t={title:this.title,body:this.body};if(this.isEditMode&&this.blogPost)this.http.patch(`${y.apiBaseUrl}/blog?id=eq.${this.blogPost.id}`,t).subscribe({next:e=>{console.log("Blog post updated:",e),this.activeModal.close(e)},error:e=>{console.error("Failed to update blog post:",e),this.errorMessage="Failed to update blog post. Please try again."}});else{let e=P(M({},t),{user_id:a});this.http.post(`${y.apiBaseUrl}/blog`,e).subscribe({next:n=>{console.log("Blog post created:",n),this.activeModal.close(n)},error:n=>{console.error("Failed to create blog post:",n),this.errorMessage="Failed to create blog post. Please try again."}})}}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=S({type:r,selectors:[["app-blog-form"]],inputs:{blogPost:"blogPost"},decls:27,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"alert","alert-danger"],[3,"ngSubmit"],[1,"mb-3"],["for","title",1,"form-label"],["type","text","id","title","name","title","placeholder","Enter blog post title","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","body",1,"form-label"],[3,"imageUploaded"],[1,"d-flex","gap-2","mb-2"],["type","button",1,"btn","btn-sm",3,"click"],["id","body","name","body","rows","15","placeholder","Write your blog post content here... (Markdown supported)","required","",1,"form-control",3,"ngModel"],[1,"border","rounded","p-3",2,"min-height","400px","background-color","#fff"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"],["id","body","name","body","rows","15","placeholder","Write your blog post content here... (Markdown supported)","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"data"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"h5",1),d(2),i(),o(3,"button",2),m("click",function(){return e.activeModal.dismiss()}),i()(),o(4,"div",3),c(5,H,2,1,"div",4),o(6,"form",5),m("ngSubmit",function(){return e.onSubmit()}),o(7,"div",6)(8,"label",7),d(9,"Title"),i(),o(10,"input",8),C("ngModelChange",function(s){return h(e.title,s)||(e.title=s),s}),i()(),o(11,"div",6)(12,"label",9),d(13,"Content (Markdown supported)"),i(),o(14,"app-image-upload",10),m("imageUploaded",function(s){return e.onImageUploaded(s)}),i(),o(15,"div",11)(16,"button",12),m("click",function(){return e.showPreview=!1}),d(17," Edit "),i(),o(18,"button",12),m("click",function(){return e.showPreview=!0}),d(19," Preview "),i()(),c(20,Y,1,1,"textarea",13)(21,J,2,1,"div",14),i(),o(22,"div",15)(23,"button",16),d(24),i(),o(25,"button",17),m("click",function(){return e.activeModal.dismiss()}),d(26," Cancel "),i()()()()),t&2&&(l(2),_(e.isEditMode?"Edit Blog Post":"New Blog Post"),l(3),b(e.errorMessage?5:-1),l(5),f("ngModel",e.title),l(6),u("btn-primary",!e.showPreview)("btn-outline-primary",e.showPreview),l(2),u("btn-primary",e.showPreview)("btn-outline-primary",!e.showPreview),l(2),b(e.showPreview?21:20),l(4),k(" ",e.isEditMode?"Update Post":"Publish"," "))},dependencies:[R,A,D,U,W,L,q,V,N,z],styles:[".modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:600}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #007bff40}.modal-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:200px}"]})};export{G as a};
